---
id: 472
title: 'MS10-006 &#8212; client-side vulnerability'
date: '2010-02-11T14:45:51-05:00'
author: 'Ron Bowes'
layout: revision
guid: 'http://www.skullsecurity.org/blog/?p=472'
permalink: '/?p=472'
---

Thanks to mentioning my name, I found [Laurent Gaffi√©'s blog](http://g-laurent.blogspot.com/) recently, including a post about [MS10-006](http://g-laurent.blogspot.com/2010/02/more-details-on-ms10-006.html) ([Microsoft Technet post](http://blogs.technet.com/srd/archive/2010/02/09/ms10-006-and-ms10-012-smb-security-bulletins.aspx)<a>). </a>

I found this vulnerability interesting, because the entire class is something I've been thinking about for a couple years. We've done all kinds of work wringing every last bug out of server implementations, but how many people have scrutinized client implements (besides the common ones like browsers, I mean).

MS10-006 is a vulnerability in the SMB *client*, which can be exploited by connecting to a malicious *server*. So how do you exploit something like that?

Well, as Laurent mentioned, I wrote a took awhile back called [Nbtool](http://www.skullsecurity.org/wiki/index.php/Nbtool) that will intercept NetBIOS requests on the local network, and respond with a chosen address. If the user is trying to access a local resource using NetBIOS name lookups, it becomes a race condition for the attacker.

Another likely avenue of attack is against so-called "road warriors", who bring their laptops to conferences, hotels, coffee shops, and other untrusted networks. If those laptops try accessing local resources, such as a file share, they'll fail. But when the DNS (or WINS) lookup fails, they'll fall back to NetBIOS and me, with [Nbtool](http://www.skullsecurity.org/wiki/index.php/Nbtool) ready, can send them a malicious address.

Now, besides stealing their hash, I can send back my special MS10-006 exploit. Win!

For what it's worth, I was on a public network earlier this week and decided to see if sending NetBIOS responses for all requests would provoke any 445 calls to my host -- it did. So this is definitely a possible vector. Now we just wait for the exploit!